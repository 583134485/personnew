<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="renderer" content="webkit">

    <title>jqGird</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link href="css/bootstrap.min.css?v=3.4.0" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css?v=4.3.0" rel="stylesheet">

    <link href="css/plugins/jQueryUI/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">

    <!-- Data Tables -->
    <link href="css/plugins/jqgrid/ui.jqgrid.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css?v=2.2.0" rel="stylesheet">

    <style>
        /* Additional style to fix warning dialog position */
        #alertmod_table_list_2 {
            top: 900px !important;
        }
    </style>

</head>

<body>
    <div id="wrapper">
        <!--侧边导航-->
        <nav class="navbar-default navbar-static-side" role="navigation">
            <!--折叠收缩-->
            <div class="sidebar-collapse">
                <!-- ul 无序列表-->
                <ul class="nav" id="side-menu">
                    <li class="nav-header">

                        <div class="dropdown profile-element"> <span>
                            <img alt="image" class="img-circle img-responsive" src="img/dog.jpg" />
                             </span>
                            <a data-toggle="dropdown" class="dropdown-toggle" href="">
                                <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold">User</strong>
                             </span> <span class="text-muted text-xs block">管理员 <b class="caret"></b></span> </span>
                            </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                <li><a href="">修改头像</a>
                                </li>
                                <li><a href="">个人资料</a>
                                </li>
                                <li><a href="">联系我们</a>
                                </li>
                                <li><a href="">信箱</a>
                                </li>
                                <li class="divider"></li>
                                <li><a href="">安全退出</a>
                                </li>
                            </ul>
                        </div>
                        <div class="logo-element">
                            H+
                        </div>

                    </li>
                    <li class="">
                        <a href=""><i class="fa fa-th-large"></i> <span class="nav-label">主页</span> <span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <!--                            <li><a href="">主页示例一</a>
                                                      </li>
                                                    <li><a href="">主页示例二</a>
                                                      </li>
                                                      <li><a href="">主页示例三</a>
                                                      </li>
                                                      <li><a href="">主页示例四</a>
                                                      </li>-->
                        </ul>
                    </li>


                    <li class="">
                        <a href="index.html"><i class="fa fa-bar-chart-o"></i> <span class="nav-label">图表</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="echarts0.html">EChartsOne</a>
                            </li>
                            <li><a href="echarts.html">EChartsOne</a>
                            </li>
                            <li><a href="echarts5.html">EChartsTwo</a>
                            </li>
                            <li><a href="echarts7.html">EChartsTwo</a>
                            </li>


                        </ul>
                    </li>
                    <li class="active">
                        <a href="#"><i class="fa fa-table"></i> <span class="nav-label">表格</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="datatables.html">datapicker</a>
                            </li>
                            <li><a href="bootstraptable.html">BootStrapTable</a>
                            </li>
                            <li><a href="table_jqgrid.html">jqGrid</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-table"></i> <span class="nav-label">文件IO</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="uploadfile.html">文件上传</a>
                            </li>
                            <li><a href="filedown.html">数据导出</a>
                            </li>

                        </ul>
                    </li>

                </ul>
            </div>
        </nav>

        <div id="page-wrapper" class="gray-bg dashbard-1">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
                        <form role="search" class="navbar-form-custom" method="post" action="">
                            <div class="form-group">
                                <input type="text" placeholder="查找的内容 …" class="form-control" name="top-search" id="top-search">
                            </div>
                        </form>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <span class="m-r-sm text-muted welcome-message"><a href="" title="返回首页"><i class="fa fa-home"></i></a></span>
                        </li>


                        <li>
                            <a href="login.html">
                                <i class="fa fa-sign-out"></i> 注册
                            </a>
                        </li>
                        <li>
                            <a href="login.html">
                                <i class="fa fa-sign-out"></i> 登陆
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <i class="fa fa-sign-out"></i> 退出
                            </a>
                        </li>
                    </ul>

                </nav>
            </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>jqGird</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="index.html">主页</a>
                        </li>
                        <li>
                            <a>表格</a>
                        </li>
                        <li>
                            <strong>jqGird</strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2">

                </div>
            </div>
            <div class="wrapper wrapper-content  animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <h5>jQuery Grid Plugin – jqGrid</h5>
                            </div>
                            <div class="ibox-content">
                                <p>
                                    <strong>jqGrid</strong> 是一个用来显示网格数据的jQuery插件，文档比较全面，附带中文版本。访问<a target="_blank" href="http://www.trirand.com/blog/"> 官网</a>
                                </p>
                                <p>jqGrid的主要特点为：</p>
                                <ol>
                                    <li>基于jquery UI主题，开发者可以根据客户要求更换不同的主题</li>
                                    <li>兼容目前所有流行的web浏览器</li>
                                    <li>Ajax分页，可以控制每页显示的记录数</li>
                                    <li>支持XML，JSON，数组形式的数据源</li>
                                    <li>提供丰富的选项配置及方法事件接口</li>
                                    <li>支持表格排序，支持拖动列、隐藏列</li>
                                    <li>支持滚动加载数据</li>
                                    <li>支持实时编辑保存数据内容</li>
                                    <li>支持子表格及树形表格</li>
                                    <li>支持多语言</li>
                                    <li>免费</li>
                                </ol>
                                <hr>
                                <h4>基本示例</h4>

                                <div class="jqGrid_wrapper">
                                    <table id="table_list_1"></table>
                                    <div id="pager_list_1"></div>
                                </div>
                                <p>&nbsp;</p>
                                <h4 class="m-t">test jqGrid</h4>
                                <button id="btn">生成jqGrid</button>
                                <div class="jqGrid_wrapper">
                                    <table id="table_list_3"></table>
                                    <div id="pager_list_3"></div>
                                </div>
                                <!---->
                                <p>从页</p>
                                <div class="jqGrid_wrapper">
                                    <table id="table_list_4"></table>
                                    <div id="pager_list_4"></div>
                                </div>
                                <h4 class="m-t">高级用法</h4>


                                <div class="jqGrid_wrapper">
                                    <table id="table_list_2"></table>
                                    <div id="pager_list_2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <div class="pull-right">
                    By：<a href="http://www.zi-han.net" target="_blank">zihan's blog</a>
                </div>
                <div>
                    <strong>Copyright</strong> H+ &copy; 2014
                </div>
            </div>

        </div>
    </div>
    <!-- Mainly scripts -->
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/bootstrap.min.js?v=3.4.0"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Peity -->
    <script src="js/plugins/peity/jquery.peity.min.js"></script>

    <!-- jqGrid -->
    <script src="js/plugins/jqgrid/i18n/grid.locale-cn.js"></script>
    <script src="js/plugins/jqgrid/jquery.jqGrid.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/hplus.js?v=2.2.0"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <!--主要啥用？？？-->
    <script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <!-- Page-Level Scripts -->
    
    <script type=application/javascript>
/*        function showtable() {
            $.ajax({
                type:"GET",
               // url:"json/datajson.json",
                url:"http://127.0.0.1:8080/libraryone/test/getjsonfile",
                async:false,
               // data:{filename:'1.jpg'},
                //接收的数据类型json
                datatype:"json",
                crossDomain: true,
                headers: { 'Access-Control-Allow-Origin': '*' },
                //contentType:"application/json;charset=utf-8",
                success:function(result){

                    console.log("data:"+result);
                    $("#table_list_3").jqGrid("clearGridData",true);
                    //api addjsondata  自己写ajax 接受数据
                    $("#table_list_3")[0].addJSONData(eval("("+result+")"));
                    //json字符串转对象
                   // var json = eval("("+result+")");
                   // console.log("type"+json.type);
                    //var jsons=JSON.stringify(result);
                   //var jsons=data.toJSONString();
                   //console.log(jsons.type);

                    //清空数据
                 /!*  $("#table_list_3").jqGrid("clearGridData",true);
                   console.log("clean down");*!/
                  /!* for(var i=0;i<=result.length;i++){
                       $("#table_list_3").jqGrid("addRowData",i+1,result[i]);
                   }*!/
                  //set 方法 获取 数据 后端模仿 官方写法
            /!*       $("#table_list_3").jqGrid("setGridParam",{
                       //不加的话 不会 显示数据
                        datatype:"json",
                       // page:1,
                       // data:json,
                        //url能成功
                       // url:"json/datajson.json",
                       url:"http://127.0.0.1:8080/libraryone/test/getjsonfile",
                        //url:"json/data1.json"
                    }).trigger("reloadGrid");
                    console.log("reload");*!/

                },
                error:function(error){
                    alert("后台问题请求失败");

                }
            });

        }*/
      function showtable() {
           //清空数据
           $("#table_list_3").jqGrid("clearGridData",true);
           console.log("clean down")
           $("#table_list_3").jqGrid("setGridParam",{
               datatype:"json",
              // url:"http://127.0.0.1:8080/libraryone/test/getjsonfile",
               // page:1,
               //data:json,
               // 单纯的json data能解析
               url:"json/datajson2.json",

               //暂时不能解析
               //url:"json/data1.json"

           }).trigger("reloadGrid");
           console.log("reload");
       }
    </script>
    <script>
        $(document).ready(function () {

            $("#btn").click(function () {

                showtable();
            })
            var mydata2=[
                {"num":"1","item":"1","qty":"1","unit":"1","linetotal":"1"},
                {"num":"1","item":"1","qty":"1","unit":"1","linetotal":"1"}
            ]

            // Examle data for jqGrid
            var mydata = [
                {
                    id: "1",
                    invdate: "2010-05-24",
                    name: "test",
                    note: "note",
                    tax: "10.00",
                    total: "2111.00"
                },
                {
                    id: "2",
                    invdate: "2010-05-25",
                    name: "test2",
                    note: "note2",
                    tax: "20.00",
                    total: "320.00"
                }



            ];

            // Configuration for jqGrid Example 1
            $("#table_list_3").jqGrid({
                //url你懂的
                //url:,
                data: mydata,
                //lcoal 初始话的时候数据
                // 接收的数据格式
                datatype: "local",
                height: 250,
                autowidth: true,
                shrinkToFit: true,
                //这个参数指定了jqGrid显示行数，默认值20。
                rowNum: 14,
                //这个参数指定了jqGrid可以接受的rowNum值，如[10,20,30]。实际上它也仅仅是一个数组
                rowList: [10, 20, 30],
                colNames: ['序号', '日期', '客户', '金额', '运费', '总额', '备注'],
                colModel: [
                    {
                        name: 'id',
                        index: 'id',
                        width: 60,
                        sorttype: "int"
                    },
                    {
                        name: 'invdate',
                        index: 'invdate',
                        width: 90,
                        sorttype: "date",
                        formatter: "date"
                    },
                    {
                        name: 'name',
                        index: 'name',
                        width: 100
                    },
                    {
                        name: 'amount',
                        index: 'amount',
                        width: 80,
                        align: "right",
                        sorttype: "float",
                        formatter: "number"
                    },
                    {
                        name: 'tax',
                        index: 'tax',
                        width: 80,
                        align: "right",
                        sorttype: "float"
                    },
                    {
                        name: 'total',
                        index: 'total',
                        width: 80,
                        align: "right",
                        sorttype: "float"
                    },
                    {
                        name: 'note',
                        index: 'note',
                        width: 150,
                        sortable: false
                    }
                ],
               // multiselect : true,
               // multikey : "ctrlKey",
                //这个参数指定了jqGrid页脚显示位置
                pager: "#pager_list_3",
                //这个参数设置了是否在Pager Bar显示所有记录的总数
                viewrecords: true,
                //这个参数制订了jqGrid的标题，如果设置了，则将显示在Grid的Header层
                caption: "自定义的初步的异步加载",
                hidegrid: false,
                repeatitems: false,
                onSelectRow:function (ids) {
                    if (ids == null) {
                        ids = 0;
                        if ($("#table_list_4").jqGrid('getGridParam',
                                'records') > 0) {
                            jQuery("#table_list_4").jqGrid(
                                'setGridParam',
                                {
                                    url : "",

                                    page : 1
                                });
                            $("#table_list_4").jqGrid('setCaption',
                                "Invoice Detail: " +"没被选？"+ ids).trigger(
                                'reloadGrid');
                        }
                    } else {

                        $.ajax({
                            url:"json/first.json",
                            datatype:"json",
                            success: function (a) {
                                $("#table_list_4").jqGrid("clearGridData",true);
                               $("#table_list_4")[0].addJSONData(a);
                            }
                        });
               /*         $("#table_list_4").jqGrid('setGridParam', {
                            //带描述的
                          //  url : "json/second.json",
                            //不带头的，间的json 纯数据的
                           // datatype: "json",
                            url:"json/first.json",
                            //page : 1
                        }).trigger("reloadGrid");*/
                        $("#table_list_4").jqGrid('setCaption',
                            "Invoice Detail: " + ids).trigger(
                            'reloadGrid');
                    }
                }
             /*   jsonReader: {  // 用于设置如何解析从Server端发回来的json数据
                    root:"data",
                    //page: "page",   // json中代表当前页码的数据
                    //total: "total", // json中代表页码总数的数据
                   // records: "records", // json中代表数据行总数的数据
                    repeatitems: false//注意此时的json结构
                }*/
            });

            $("#table_list_4").jqGrid({
                height: 250,
                autowidth: true,
                shrinkToFit: true,
                //url : ctx+'/SubGrid?q=1&id=0',
                //data daatype=lcoal 可以添加json 数组
                //url 不能直接get 到first.json /data 可以？？
                // first.json  数量到了3个之后又可以传入了
               // url:"json/first.json",
                //second.json 可以get
               // url:"json/second.json",
                datatype:"json",
              //  data:mydata2,
               //  datatype : "local",
                colNames : [ 'No', 'Item', 'Qty', 'Unit', 'Line Total' ],
                colModel : [
                    {name : 'num',index : 'num',width : 55},
                    {name : 'item',index : 'item',width : 180},
                    {name : 'qty',index : 'qty',width : 80,align : "right"},
                    {name : 'unit',index : 'unit',width : 80,align : "right"},
                    {name : 'linetotal',index : 'linetotal',width : 80,align : "right",sortable : false,search : false}
                ],
                //repeatitems: false,

               // rowNum : 5,
                rowList : [ 5, 10, 20 ],
                pager : '#pager_list_4',
                //sortname : 'item',
                viewrecords : true,
                //hidegrid: false,
                sortorder : "asc",
                //multiselect : true,
                caption : "从页"
/*                repeatitems: false,
                     jsonReader : {
                         root:"rows",

                     },*/

            });
            // Configuration for jqGrid Example 1
            var lastsel;
            $("#table_list_1").jqGrid({
                //url你懂的
                //url:"",
                data: mydata,
                //lcoal ????
                //接收的数据格式
                datatype: "local",
                height: 250,
                autowidth: true,
                shrinkToFit: true,
                //这个参数指定了jqGrid显示行数，默认值20。
                rowNum: 14,
                //这个参数指定了jqGrid可以接受的rowNum值，如[10,20,30]。实际上它也仅仅是一个数组
                rowList: [10, 20, 30],
                sortname : 'id',
                colNames: ['序号', '日期', '客户', '金额', '运费', '总额', '备注'],

                colModel: [
                    {
                        name: 'id',
                        index: 'id',
                        width: 60,
                        sorttype: "int",
                        editable : true
                    },
                    {
                        name: 'invdate',
                        index: 'invdate',
                        width: 90,
                        sorttype: "date",
                        formatter: "date",

                        editable : true,
                        editoptions : {size : 10},editrules : {required : true}
                    },
                    {
                        name: 'name',
                        index: 'name',
                        width: 100,
                        editable : true
                    },
                    {
                        name: 'amount',
                        index: 'amount',
                        width: 80,
                        align: "right",
                        sorttype: "float",
                        formatter: "number",
                        editable : true
                    },
                    {
                        name: 'tax',
                        index: 'tax',
                        width: 80,
                        align: "right",
                        sorttype: "float",
                        editable : true
                    },
                    {
                        name: 'total',
                        index: 'total',
                        width: 80,
                        align: "right",
                        sorttype: "float",
                        editable : true
                    },
                    {
                        name: 'note',
                        index: 'note',
                        width: 150,
                        sortable: false,
                        editable : true
                    }
                ],

               // multiselect:true,
                //无是官方写法还是其他 都没能生效
                onSelectRow : function(id) {
                    console.log("onSelectRow"+"lastsetl"+lastsel)
                    if (id && id !== lastsel) {
                        jQuery('#table_list_1').jqGrid('restoreRow', lastsel);
                        jQuery('#table_list_1').jqGrid('editRow', id, true);
                        lastsel = id;
                    }


                },
                editurl : "http://127.0.0.1:8080/libraryone/test/editurl",
                //这个参数指定了jqGrid页脚显示位置
                pager: "#pager_list_1",
                //这个参数设置了是否在Pager Bar显示所有记录的总数
                viewrecords: true,
                //这个参数制订了jqGrid的标题，如果设置了，则将显示在Grid的Header层
                caption: "jqGrid 示例1",
                hidegrid: false
            });
            jQuery("#table_list_1").jqGrid('navGrid', "#pager_list_1", {
                edit : false,
                add : false,
                del : false
            });

            // Configuration for jqGrid Example 2
            $("#table_list_2").jqGrid({
                // search url 的默认地址
                //url:"http://127.0.0.1:8080/libraryone/test/editurl",
                data: mydata,
                mtype : "POST",
                datatype: "local",
                height: 450,
                autowidth: true,
                shrinkToFit: true,
                rowNum: 20,
                rowList: [10, 20, 30],
                colNames: ['序号', '日期', '客户', '金额', '运费', '总额', '备注'],
                colModel: [
                    {
                        name: 'id',
                        index: 'id',
                        editable: true,
                        width: 60,
                        sorttype: "int",
                        search: true
                    },
                    {
                        name: 'invdate',
                        index: 'invdate',
                        editable: true,
                        width: 90,
                        sorttype: "date",
                        formatter: "date"
                    },
                    {
                        name: 'name',
                        index: 'name',
                        editable: true,
                        width: 100
                    },
                    {
                        name: 'amount',
                        index: 'amount',
                        editable: true,
                        width: 80,
                        align: "right",
                        sorttype: "float",
                        formatter: "number"
                    },
                    {
                        name: 'tax',
                        index: 'tax',
                        editable: true,
                        width: 80,
                        align: "right",
                        sorttype: "float"
                    },
                    {
                        name: 'total',
                        index: 'total',
                        editable: true,
                        width: 80,
                        align: "right",
                        sorttype: "float"
                    },
                    {
                        name: 'note',
                        index: 'note',
                        editable: true,
                        width: 100,
                        sortable: false
                    }
                ],
                //只加载一次，作用是 能 本地筛选数据 ，false 的话 就默认从 url 搜索数据
                loadonce:true,
                pager: "#pager_list_2",
                viewrecords: true,
                caption: "jqGrid 示例2",
                editurl:"http://127.0.0.1:8080/libraryone/test/editurl",
                add: true,
                edit: true,
                addtext: 'Add',
                edittext: 'Edit',
                hidegrid: false
            });

            // Add selection
            $("#table_list_2").setSelection(4, true);


            // Setup buttons 增删改查
            $("#table_list_2").jqGrid('navGrid', '#pager_list_2', {

                edit: true,
                add: true,
                //del: true,
                search: true

            }, {
                height: 400,
                //如果false 会出现 提交原始数据情况
               reloadAfterSubmit: true
            });

            // Add responsive to jqGrid
            $(window).bind('resize', function () {
                var width = $('.jqGrid_wrapper').width();
                $('#table_list_1').setGridWidth(width);
                $('#table_list_2').setGridWidth(width);
                $('#table_list_3').setGridWidth(width);
                $('#table_list_4').setGridWidth(width);
            });
        });
    </script>


</body>

</html>
